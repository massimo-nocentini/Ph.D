% article example for classicthesis.sty
\documentclass[a4paper,dottedtoc,headinclude,footinclude]{report} % KOMA-Script article scrartcl

\usepackage[pdfspacing,beramono,eulermath]{classicthesis} % nochapters
\usepackage{arsclassica}
\usepackage{lipsum}
\usepackage{url}
\usepackage{graphicx}
\usepackage{float}
\usepackage{amsthm, latexsym}
\usepackage{amssymb}
\usepackage{bm}
\usepackage{caption}
\usepackage{marginnote}
\usepackage{bbold}
\usepackage{minted}
\usepackage[T1]{fontenc} % T2A for cyrillics
\usepackage[utf8]{inputenc}				
\usepackage{rotating}				

\newcommand{\R}{{\mathbb R}}
\newcommand{\Q}{{\mathbb Q}}
\newcommand{\C}{{\mathbb C}}
\newcommand{\N}{{\mathbb N}}
\newcommand{\Z}{{\mathbb Z}}

\newcommand{\myTitle}{On unfolding recurrence relations\xspace}
%\newcommand{\mySubtitle}{$\equiv_{p}$ and $h$ characterizations\xspace}
\newcommand{\myDegree}{\xspace}
\newcommand{\myName}{Massimo Nocentini\xspace}
\newcommand{\myProf}{Donatella Merlini\xspace}
\newcommand{\myOtherProf}{Put name here\xspace}
\newcommand{\mySupervisor}{Put name here\xspace}
%\newcommand{\myFaculty}{{S}cuola di {S}cienze {M}atematiche, {F}isiche e {N}aturali\xspace}
\newcommand{\myDepartment}{Dipartimento Statistica, Informatica, Applicazioni ``G. Parenti''\xspace}
\newcommand{\myUni}{\xspace}
\newcommand{\myLocation}{Firenze\xspace}
\newcommand{\myTime}{January 2016\xspace}
%\newcommand{\myVersion}{version 1.0\xspace}

\theoremstyle{plain}
%\numberwithin{equation}{section}
\newtheorem{thm}{Theorem}[section]
\newtheorem{theorem}[thm]{Theorem}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{example}[thm]{Example}
\newtheorem{definition}[thm]{Definition}
\newtheorem{proposition}[thm]{Proposition}



\begin{document}

    %\title{\rmfamily\normalfont\spacedallcaps{On recurrences unfolding}}
    %\author{\spacedlowsmallcaps{Massimo Nocentini}}
    %\date{\today} 



%    \maketitle
    
    \begin{titlepage}
        \begin{center}
        \large
          \hfill
          \vfill
          \begingroup
             \includegraphics[scale=0.15]{gfx/logo/unifi}\\
    			%\spacedallcaps{Universit\`a degli Studi di Firenze} \\ 
                %\myFaculty \\
                Corso di Dottorato in Matematica, Informatica, Statistica\\ 
                \vspace{0.5cm}
             \vspace{0.5cm}    
             Research Report
          \endgroup 
          \vfill 
          \begingroup
            \color{Maroon}\spacedallcaps{On unfolding recurrences} \\ $\ $\\
        \bigskip
          \endgroup
          \spacedlowsmallcaps{Massimo Nocentini}
          \vfill  
          %Relatore: \itshape{\myProf}
          \vfill                   
            January 2016
          \vfill                      
        \end{center}        
    \end{titlepage}   

    \begin{abstract}
        \noindent In this document we show an implementation of a prototype 
        using the \emph{Python} language, on top of \emph{SymPy} module.
        It allows us to \emph{unfold} recurrence relations, where there
        is \emph{one} free variable. We show some applications to recurrences
        describing average numbers of Quicksort's checks and swaps; moreover, 
        possibly new characterizations for Fibonacci numbers are given.
    \end{abstract}
       
    \tableofcontents
    
    \chapter{Language definition}
    \lipsum[1]

    \chapter{Quicksort recurrences}

    \section{On the average number of checks}

    Let $c_{n}$ be the number of checks occuring on the computation
    of Quicksort algorithm on a vector of length $n$. After some manipulation
    starting from a general relation over $c_{n}$, which is derived from
    Quicksort algorithm implementation directly, the following
    recurrence relation can be derived:
    \begin{equation}
        \label{eq:quicksort-checks-recurrence}
        \frac{c_{n}}{n + 1} = \frac{2}{n + 1} + \frac{1}{n} c_{n - 1}
    \end{equation}
    one unfolding step allows us to rewrite term $\frac{1}{n} c_{n - 1}$, 
    rewriting the starting relation as:
    \begin{displaymath}
        \frac{c_{n}}{n + 1} = \frac{c_{n - 2}}{n - 1} + \frac{2}{n} + \frac{2}{n + 1}
    \end{displaymath}
    Doing $3$ more unfolding steps from the above recurrence yield the
    new recurrence:
    \begin{displaymath}
        \frac{c_{n}}{n + 1} = \frac{2}{n - 3} + \frac{c_{n - 5}}{n - 4} + \frac{2}{n + 1} + \frac{2}{n} + \frac{2}{n - 1} + \frac{2}{n - 2}
    \end{displaymath}
    To reach previous recurrence, the following subterms have been unfolded,
    according \autoref{eq:quicksort-checks-recurrence}:
    \begin{displaymath}
        \left \{ \frac{1}{n} c_{n - 1} : \frac{c_{n - 2}}{n - 1} + \frac{2}{n}, \quad \frac{c_{n - 4}}{n - 3} : \frac{2}{n - 3} + \frac{c_{n - 5}}{n - 4}, \quad \frac{c_{n - 3}}{n - 2} : \frac{2}{n - 2} + \frac{c_{n - 4}}{n - 3}, \quad \frac{c_{n - 2}}{n - 1} : \frac{2}{n - 1} + \frac{c_{n - 3}}{n - 2}\right \}
    \end{displaymath}


    \subsection{A Subsection}
    \lipsum[1]

    \section{A Section}
    \lipsum[1]
    
    \chapter{On Fibonacci numbers}
    
    \section{First Order unfolding}
    
    We use the following recurrence to symbolically characterize Fibonacci numbers: 
    \begin{equation}
        \label{eq:fib:first:order:unfolding}
        f_{n + 2} = f_{n} + f_{n + 1}
    \end{equation}
    In this section we are interested in applying \emph{first order} unfolding
    to such relation, namely unfold both term $f_{n}$ and $t_{n+1}$ according
    \autoref{eq:fib:first:order:unfolding}. Doing one unfolding step yield:
    \begin{displaymath} 
        f_{n + 2} = f_{n - 2} + 2 f_{n - 1} + f_{n}
    \end{displaymath}
    Doing one more unfolding step yield:
    \begin{displaymath} 
        f_{n + 2} = f_{n - 4} + 3 f_{n - 3} + 3 f_{n - 2} + f_{n - 1}
    \end{displaymath}
    let us continue to unfold up to $9$ times, collecting relations in 
    \autoref{triangle:fib:first:order} and in \autoref{matrix:notation:triangle:fib:first:order}
    using matrix notation. These tables allow us to derive the 
    following generalization, which we state as a theorem.

    \begin{thm} Let $f_{n}$ denote the $n$-th Fibonacci number.
        \begin{displaymath} 
            f_{n} = \sum_{k=0}^{m} {{{m}\choose{k}} f_{n - 2 m + k}}
        \end{displaymath} 
    \end{thm}

    
    \begin{sidewaystable}

        \begin{eqnarray}
            & f_{n + 2} = f_{n} + f_{n + 1} \\
            & f_{n + 2} = f_{n} + f_{n - 2} + 2 f_{n - 1}\\
            & f_{n + 2} = f_{n - 4} + 3 f_{n - 3} + 3 f_{n - 2} + f_{n - 1}\\
            & f_{n + 2} = f_{n - 6} + 4 f_{n - 5} + 6 f_{n - 4} + 4 f_{n - 3} + f_{n - 2}\\
            & f_{n + 2} = f_{n - 8} + 5 f_{n - 7} + 10 f_{n - 6} + 10 f_{n - 5} + 5 f_{n - 4} + f_{n - 3}\\
            & f_{n + 2} = f_{n - 10} + 6 f_{n - 9} + 15 f_{n - 8} + 20 f_{n - 7} + 15 f_{n - 6} + 6 f_{n - 5} + f_{n - 4}\\
            & f_{n + 2} = f_{n - 12} + 7 f_{n - 11} + 21 f_{n - 10} + 35 f_{n - 9} + 35 f_{n - 8} + 21 f_{n - 7} + 7 f_{n - 6} + f_{n - 5}\\
            & f_{n + 2} = f_{n - 14} + 8 f_{n - 13} + 28 f_{n - 12} + 56 f_{n - 11} + 70 f_{n - 10} + 56 f_{n - 9} + 28 f_{n - 8} + 8 f_{n - 7} + f_{n - 6}\\
            & f_{n + 2} = f_{n - 16} + 9 f_{n - 15} + 36 f_{n - 14} + 84 f_{n - 13} + 126 f_{n - 12} + 126 f_{n - 11} + 84 f_{n - 10} + 36 f_{n - 9} + 9 f_{n - 8} + f_{n - 7}\\
            & f_{n + 2} = f_{n - 18} + 10 f_{n - 17} + 45 f_{n - 16} + 120 f_{n - 15} + 210 f_{n - 14} + 252 f_{n - 13} + 210 f_{n - 12} + 120 f_{n - 11} + 45 f_{n - 10} + 10 f_{n - 9} + f_{n - 8}
            \end{eqnarray}

        \caption{Relations produced by $0$ up to $9$ \emph{first order} unfolding steps}
        \label{triangle:fib:first:order}
    \end{sidewaystable}
    
    \begin{sidewaystable}

        \begin{displaymath}
            \left[\begin{array}{ccccccccccccccccccccc}
                1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                0 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                0 & 0 & 1 & 2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                0 & 0 & 0 & 1 & 3 & 3 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                0 & 0 & 0 & 0 & 1 & 4 & 6 & 4 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                0 & 0 & 0 & 0 & 0 & 1 & 5 & 10 & 10 & 5 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                0 & 0 & 0 & 0 & 0 & 0 & 1 & 6 & 15 & 20 & 15 & 6 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 7 & 21 & 35 & 35 & 21 & 7 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
                0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 8 & 28 & 56 & 70 & 56 & 28 & 8 & 1 & 0 & 0 & 0 & 0\\
                0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 9 & 36 & 84 & 126 & 126 & 84 & 36 & 9 & 1 & 0 & 0\\
                0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 10 & 45 & 120 & 210 & 252 & 210 & 120 & 45 & 10 & 1
                \end{array}\right]  \quad % matrix * vector
                \left[
                    \begin{array}{c}
                        f_{n + 2}\\
                        f_{n + 1}\\
                        f_{n}\\
                        f_{n - 1}\\
                        f_{n - 2}\\
                        f_{n - 3}\\
                        f_{n - 4}\\
                        f_{n - 5}\\
                        f_{n - 6}\\
                        f_{n - 7}\\
                        f_{n - 8}\\
                        f_{n - 9}\\
                        f_{n - 10}\\
                        f_{n - 11}\\
                        f_{n - 12}\\
                        f_{n - 13}\\
                        f_{n - 14}\\
                        f_{n - 15}\\
                        f_{n - 16}\\
                        f_{n - 17}\\
                        f_{n - 18}
                        \end{array}\right] \quad = \quad 
                \left[
                    \begin{array}{c}
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}\\
                        f_{n + 2}
                        \end{array}\right]
            \end{displaymath}

        \caption{Matrix notation of \autoref{triangle:fib:first:order}}
        \label{matrix:notation:triangle:fib:first:order}
    \end{sidewaystable}

    \subsection{First accumulation}

    We provide another generalization produced by \emph{accumulating}
    relations in \autoref{triangle:fib:first:order}: in 
    \autoref{triangle:fib:first:order:first:accumulation} result of a first
    accumulation scan are shown. Leftmost matrix in 
    \autoref{matrix:notation:triangle:fib:first:order:first:accumulation}
    is known as A$027926$\footnote{\url{http://oeis.org/A027926}} and, 
    letting $d_{nk}$ the generic element in row $r$ and column $k$, is
    characterized as follows:
    \begin{displaymath}
        d_{00} = 1 \quad d_{n, 2n} = 1 \quad d_{n+1,k+1} = d_{n, k-1} + d_{n, k}  
    \end{displaymath}
    therefore we can derive another identity, giving it as a theorem.

    \begin{thm}
        \begin{displaymath}
            \left(k + 1\right) f_{n} = \sum_{i=0}^{2 k}  d_{k,2 k - i} f_{n - i}
        \end{displaymath}
    \end{thm}


    \begin{sidewaystable}
        \scriptsize
        \begin{eqnarray}
             & f_{n + 2} = f_{n + 2}\\
             & 2 f_{n + 2} = f_{n} + f_{n + 1} + f_{n + 2}\\
             & 3 f_{n + 2} = 2 f_{n} + f_{n - 2} + 2 f_{n - 1} + f_{n + 1} + f_{n + 2}\\
             & 4 f_{n + 2} = 2 f_{n} + f_{n - 4} + 3 f_{n - 3} + 4 f_{n - 2} + 3 f_{n - 1} + f_{n + 1} + f_{n + 2}\\
             & 5 f_{n + 2} = 2 f_{n} + f_{n - 6} + 4 f_{n - 5} + 7 f_{n - 4} + 7 f_{n - 3} + 5 f_{n - 2} + 3 f_{n - 1} + f_{n + 1} + f_{n + 2}\\
             & 6 f_{n + 2} = 2 f_{n} + f_{n - 8} + 5 f_{n - 7} + 11 f_{n - 6} + 14 f_{n - 5} + 12 f_{n - 4} + 8 f_{n - 3} + 5 f_{n - 2} + 3 f_{n - 1} + f_{n + 1} + f_{n + 2}\\
             & 7 f_{n + 2} = 2 f_{n} + f_{n - 10} + 6 f_{n - 9} + 16 f_{n - 8} + 25 f_{n - 7} + 26 f_{n - 6} + 20 f_{n - 5} + 13 f_{n - 4} + 8 f_{n - 3} + 5 f_{n - 2} + 3 f_{n - 1} + f_{n + 1} + f_{n + 2}\\
             & 8 f_{n + 2} = 2 f_{n} + f_{n - 12} + 7 f_{n - 11} + 22 f_{n - 10} + 41 f_{n - 9} + 51 f_{n - 8} + 46 f_{n - 7} + 33 f_{n - 6} + 21 f_{n - 5} + 13 f_{n - 4} + 8 f_{n - 3} + 5 f_{n - 2} + 3 f_{n - 1} + f_{n + 1} + f_{n + 2}\\
             & 9 f_{n + 2} = 2 f_{n} + f_{n - 14} + 8 f_{n - 13} + 29 f_{n - 12} + 63 f_{n - 11} + 92 f_{n - 10} + 97 f_{n - 9} + 79 f_{n - 8} + 54 f_{n - 7} + 34 f_{n - 6} + 21 f_{n - 5} + 13 f_{n - 4} + 8 f_{n - 3} + 5 f_{n - 2} + 3 f_{n - 1} + f_{n + 1} + f_{n + 2}\\
             & 10 f_{n + 2} = 2 f_{n} + f_{n - 16} + 9 f_{n - 15} + 37 f_{n - 14} + 92 f_{n - 13} + 155 f_{n - 12} + 189 f_{n - 11} + 176 f_{n - 10} + 133 f_{n - 9} + 88 f_{n - 8} + 55 f_{n - 7} + 34 f_{n - 6} + 21 f_{n - 5} + 13 f_{n - 4} + 8 f_{n - 3} + 5 f_{n - 2} + 3 f_{n - 1} + f_{n + 1} + f_{n + 2}\\
             & 11 f_{n + 2} = 2 f_{n} + f_{n - 18} + 10 f_{n - 17} + 46 f_{n - 16} + 129 f_{n - 15} + 247 f_{n - 14} + 344 f_{n - 13} + 365 f_{n - 12} + 309 f_{n - 11} + 221 f_{n - 10} + 143 f_{n - 9} + 89 f_{n - 8} + 55 f_{n - 7} + 34 f_{n - 6} + 21 f_{n - 5} + 13 f_{n - 4} + 8 f_{n - 3} + 5 f_{n - 2} + 3 f_{n - 1} + f_{n + 1} + f_{n + 2}
            \end{eqnarray}

        \caption{Relations produced by accumulating equation in 
            \autoref{triangle:fib:first:order}}
        \label{triangle:fib:first:order:first:accumulation}
    \end{sidewaystable}

    \begin{sidewaystable}
        \begin{displaymath}
            \left[
                \begin{array}{ccccccccccccccccccccc}
                1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                1 & 1 & 2 & 2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                1 & 1 & 2 & 3 & 4 & 3 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                1 & 1 & 2 & 3 & 5 & 7 & 7 & 4 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                1 & 1 & 2 & 3 & 5 & 8 & 12 & 14 & 11 & 5 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                1 & 1 & 2 & 3 & 5 & 8 & 13 & 20 & 26 & 25 & 16 & 6 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                1 & 1 & 2 & 3 & 5 & 8 & 13 & 21 & 33 & 46 & 51 & 41 & 22 & 7 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
                1 & 1 & 2 & 3 & 5 & 8 & 13 & 21 & 34 & 54 & 79 & 97 & 92 & 63 & 29 & 8 & 1 & 0 & 0 & 0 & 0\\
                1 & 1 & 2 & 3 & 5 & 8 & 13 & 21 & 34 & 55 & 88 & 133 & 176 & 189 & 155 & 92 & 37 & 9 & 1 & 0 & 0\\
                1 & 1 & 2 & 3 & 5 & 8 & 13 & 21 & 34 & 55 & 89 & 143 & 221 & 309 & 365 & 344 & 247 & 129 & 46 & 10 & 1
                \end{array}
                \right]  \quad % matrix * vector
                \left[
                    \begin{array}{c}
                        f_{n + 2}\\
                        f_{n + 1}\\
                        f_{n}\\
                        f_{n - 1}\\
                        f_{n - 2}\\
                        f_{n - 3}\\
                        f_{n - 4}\\
                        f_{n - 5}\\
                        f_{n - 6}\\
                        f_{n - 7}\\
                        f_{n - 8}\\
                        f_{n - 9}\\
                        f_{n - 10}\\
                        f_{n - 11}\\
                        f_{n - 12}\\
                        f_{n - 13}\\
                        f_{n - 14}\\
                        f_{n - 15}\\
                        f_{n - 16}\\
                        f_{n - 17}\\
                        f_{n - 18}
                        \end{array}\right] \quad = \quad 
                \left[
                    \begin{array}{c}
                        f_{n + 2}\\
                        2 f_{n + 2}\\
                        3 f_{n + 2}\\
                        4 f_{n + 2}\\
                        5 f_{n + 2}\\
                        6 f_{n + 2}\\
                        7 f_{n + 2}\\
                        8 f_{n + 2}\\
                        9 f_{n + 2}\\
                        10 f_{n + 2}\\
                        11 f_{n + 2}
                        \end{array}\right]
            \end{displaymath}

        \caption{Matrix notation of \autoref{triangle:fib:first:order:first:accumulation}}
        \label{matrix:notation:triangle:fib:first:order:first:accumulation}
    \end{sidewaystable}

    \begin{sidewaystable}
        \begin{displaymath}
            \left[
                \begin{array}{ccccccccccccccccccccc}
                f_{1} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{1} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{3} & f_{2} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{4} & 4 & f_{4} & f_{2} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{4} & f_{5} & 7 & 7 & 4 & f_{2} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{4} & f_{5} & f_{6} & 12 & 14 & 11 & f_{5} & f_{2} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{4} & f_{5} & f_{6} & f_{7} & 20 & 26 & 25 & 16 & 6 & f_{2} & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{4} & f_{5} & f_{6} & f_{7} & f_{8} & 33 & 46 & 51 & 41 & 22 & 7 & f_{2} & 0 & 0 & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{4} & f_{5} & f_{6} & f_{7} & f_{8} & f_{9} & 54 & 79 & 97 & 92 & 63 & 29 & f_{6} & f_{2} & 0 & 0 & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{4} & f_{5} & f_{6} & f_{7} & f_{8} & f_{9} & f_{10} & 88 & 133 & 176 & 189 & 155 & 92 & 37 & 9 & f_{2} & 0 & 0\\
                f_{1} & f_{2} & f_{3} & f_{4} & f_{5} & f_{6} & f_{7} & f_{8} & f_{9} & f_{10} & f_{11} & 143 & 221 & 309 & 365 & 344 & 247 & 129 & 46 & 10 & f_{2}
                \end{array}
                \right]  \quad % matrix * vector
                \left[
                    \begin{array}{c}
                        f_{n + 2}\\
                        f_{n + 1}\\
                        f_{n}\\
                        f_{n - 1}\\
                        f_{n - 2}\\
                        f_{n - 3}\\
                        f_{n - 4}\\
                        f_{n - 5}\\
                        f_{n - 6}\\
                        f_{n - 7}\\
                        f_{n - 8}\\
                        f_{n - 9}\\
                        f_{n - 10}\\
                        f_{n - 11}\\
                        f_{n - 12}\\
                        f_{n - 13}\\
                        f_{n - 14}\\
                        f_{n - 15}\\
                        f_{n - 16}\\
                        f_{n - 17}\\
                        f_{n - 18}
                        \end{array}\right] \quad = \quad 
                \left[
                    \begin{array}{c}
                        f_{n + 2}\\
                        2 f_{n + 2}\\
                        3 f_{n + 2}\\
                        4 f_{n + 2}\\
                        5 f_{n + 2}\\
                        6 f_{n + 2}\\
                        7 f_{n + 2}\\
                        8 f_{n + 2}\\
                        9 f_{n + 2}\\
                        10 f_{n + 2}\\
                        11 f_{n + 2}
                        \end{array}\right]
            \end{displaymath}

        \caption{Fibonacci substitution within matrix notation of 
            \autoref{matrix:notation:triangle:fib:first:order:first:accumulation}}
        \label{matrix:notation:triangle:fib:first:order:first:accumulation:substituting:fibs}
    \end{sidewaystable}

    \subsection{Second accumulation}

    In \autoref{triangle:fib:first:order:second:accumulation} we report
    a second accumulation and in \autoref{matrix:notation:triangle:fib:first:order:second:accumulation}
    its matrix notation.

    \begin{sidewaystable}
        \scriptsize
        \begin{eqnarray}
            & f_{n + 2} = f_{n + 2}\\
            & 2 f_{n + 2} = f_{n} + f_{n + 1} + f_{n + 2}\\
            & 4 f_{n + 2} = 3 f_{n} + f_{n - 2} + 2 f_{n - 1} + 2 f_{n + 1} + f_{n + 2}\\
            & 7 f_{n + 2} = 5 f_{n} + f_{n - 4} + 3 f_{n - 3} + 5 f_{n - 2} + 5 f_{n - 1} + 3 f_{n + 1} + f_{n + 2}\\
            & 11 f_{n + 2} = 7 f_{n} + f_{n - 6} + 4 f_{n - 5} + 8 f_{n - 4} + 10 f_{n - 3} + 10 f_{n - 2} + 8 f_{n - 1} + 4 f_{n + 1} + f_{n + 2}\\
            & 16 f_{n + 2} = 9 f_{n} + f_{n - 8} + 5 f_{n - 7} + 12 f_{n - 6} + 18 f_{n - 5} + 20 f_{n - 4} + 18 f_{n - 3} + 15 f_{n - 2} + 11 f_{n - 1} + 5 f_{n + 1} + f_{n + 2}\\
            & 22 f_{n + 2} = 11 f_{n} + f_{n - 10} + 6 f_{n - 9} + 17 f_{n - 8} + 30 f_{n - 7} + 38 f_{n - 6} + 38 f_{n - 5} + 33 f_{n - 4} + 26 f_{n - 3} + 20 f_{n - 2} + 14 f_{n - 1} + 6 f_{n + 1} + f_{n + 2}\\
            & 29 f_{n + 2} = 13 f_{n} + f_{n - 12} + 7 f_{n - 11} + 23 f_{n - 10} + 47 f_{n - 9} + 68 f_{n - 8} + 76 f_{n - 7} + 71 f_{n - 6} + 59 f_{n - 5} + 46 f_{n - 4} + 34 f_{n - 3} + 25 f_{n - 2} + 17 f_{n - 1} + 7 f_{n + 1} + f_{n + 2}\\
            & 37 f_{n + 2} = 15 f_{n} + f_{n - 14} + 8 f_{n - 13} + 30 f_{n - 12} + 70 f_{n - 11} + 115 f_{n - 10} + 144 f_{n - 9} + 147 f_{n - 8} + 130 f_{n - 7} + 105 f_{n - 6} + 80 f_{n - 5} + 59 f_{n - 4} + 42 f_{n - 3} + 30 f_{n - 2} + 20 f_{n - 1} + 8 f_{n + 1} + f_{n + 2}\\
            & 46 f_{n + 2} = 17 f_{n} + f_{n - 16} + 9 f_{n - 15} + 38 f_{n - 14} + 100 f_{n - 13} + 185 f_{n - 12} + 259 f_{n - 11} + 291 f_{n - 10} + 277 f_{n - 9} + 235 f_{n - 8} + 185 f_{n - 7} + 139 f_{n - 6} + 101 f_{n - 5} + 72 f_{n - 4} + 50 f_{n - 3} + 35 f_{n - 2} + 23 f_{n - 1} + 9 f_{n + 1} + f_{n + 2}\\
            & 56 f_{n + 2} = 19 f_{n} + f_{n - 18} + 10 f_{n - 17} + 47 f_{n - 16} + 138 f_{n - 15} + 285 f_{n - 14} + 444 f_{n - 13} + 550 f_{n - 12} + 568 f_{n - 11} + 512 f_{n - 10} + 420 f_{n - 9} + 324 f_{n - 8} + 240 f_{n - 7} + 173 f_{n - 6} + 122 f_{n - 5} + 85 f_{n - 4} + 58 f_{n - 3} + 40 f_{n - 2} + 26 f_{n - 1} + 10 f_{n + 1} + f_{n + 2}
            \end{eqnarray}

        \caption{Relations produced by accumulating equation in 
            \autoref{triangle:fib:first:order:first:accumulation}}
        \label{triangle:fib:first:order:second:accumulation}
    \end{sidewaystable}

    \begin{sidewaystable}
        \begin{displaymath}
            \left[
                \begin{array}{ccccccccccccccccccccc}
                    1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    1 & 1 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    1 & 2 & 3 & 2 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    1 & 3 & 5 & 5 & 5 & 3 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    1 & 4 & 7 & 8 & 10 & 10 & 8 & 4 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    1 & 5 & 9 & 11 & 15 & 18 & 20 & 18 & 12 & 5 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    1 & 6 & 11 & 14 & 20 & 26 & 33 & 38 & 38 & 30 & 17 & 6 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
                    1 & 7 & 13 & 17 & 25 & 34 & 46 & 59 & 71 & 76 & 68 & 47 & 23 & 7 & 1 & 0 & 0 & 0 & 0 & 0 & 0\\
                    1 & 8 & 15 & 20 & 30 & 42 & 59 & 80 & 105 & 130 & 147 & 144 & 115 & 70 & 30 & 8 & 1 & 0 & 0 & 0 & 0\\
                    1 & 9 & 17 & 23 & 35 & 50 & 72 & 101 & 139 & 185 & 235 & 277 & 291 & 259 & 185 & 100 & 38 & 9 & 1 & 0 & 0\\
                    1 & 10 & 19 & 26 & 40 & 58 & 85 & 122 & 173 & 240 & 324 & 420 & 512 & 568 & 550 & 444 & 285 & 138 & 47 & 10 & 1
                \end{array}
                \right]  \quad % matrix * vector
                \left[
                    \begin{array}{c}
                        f_{n + 2}\\
                        f_{n + 1}\\
                        f_{n}\\
                        f_{n - 1}\\
                        f_{n - 2}\\
                        f_{n - 3}\\
                        f_{n - 4}\\
                        f_{n - 5}\\
                        f_{n - 6}\\
                        f_{n - 7}\\
                        f_{n - 8}\\
                        f_{n - 9}\\
                        f_{n - 10}\\
                        f_{n - 11}\\
                        f_{n - 12}\\
                        f_{n - 13}\\
                        f_{n - 14}\\
                        f_{n - 15}\\
                        f_{n - 16}\\
                        f_{n - 17}\\
                        f_{n - 18}
                        \end{array}\right] \quad = \quad 
                \left[
                    \begin{array}{c}
                        f_{n + 2}\\
                        2 f_{n + 2}\\
                        4 f_{n + 2}\\
                        7 f_{n + 2}\\
                        11 f_{n + 2}\\
                        16 f_{n + 2}\\
                        22 f_{n + 2}\\
                        29 f_{n + 2}\\
                        37 f_{n + 2}\\
                        46 f_{n + 2}\\
                        56 f_{n + 2}
                        \end{array}\right]
            \end{displaymath}

        \caption{Matrix notation of \autoref{triangle:fib:first:order:second:accumulation}}
        \label{matrix:notation:triangle:fib:first:order:second:accumulation}
    \end{sidewaystable}

    \section{Second Order unfolding}
    \lipsum[1]

    \iffalse
    % bib stuff
    \nocite{*}
    \addtocontents{toc}{\protect\vspace{\beforebibskip}}
    \addcontentsline{toc}{section}{\refname}    
    \bibliographystyle{plain}
    \bibliography{../Bibliography}
    \fi

\end{document}
